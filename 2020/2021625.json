{
 "awd_id": "2021625",
 "agcy_id": "NSF",
 "tran_type": "Grant",
 "awd_istr_txt": "Standard Grant",
 "awd_titl_txt": "Accurate Linearization and Control of Non-linear Physical Systems using Increased Variables",
 "cfda_num": "47.041",
 "org_code": "07030000",
 "po_phone": "7032922576",
 "po_email": "mcanova@nsf.gov",
 "po_sign_block_name": "Marcello Canova",
 "awd_eff_date": "2020-09-01",
 "awd_exp_date": "2024-08-31",
 "tot_intn_awd_amt": 478947.0,
 "awd_amount": 478947.0,
 "awd_min_amd_letter_date": "2020-08-20",
 "awd_max_amd_letter_date": "2020-10-13",
 "awd_abstract_narration": "Advanced control systems, such as self-driving cars, autonomous robots, and bio-reactors, exhibit complex behaviors, which do not follow simple proportional rules and linear relationships. Control of those non-linear systems remains a challenge for engineers in many industrial sectors. This research aims to reduce a complex, nonlinear system to a linear system while retaining the original nonlinear behaviors. Once converted to a linear system, control design becomes easier and computational complexity significantly reduces. This advantageous result is made possible by representing the system with more variables than we usually use. While a traditional description using a limited number of variables leads to non-linearity, this new method using more variables allows one to deal with non-linearity in a linear domain. With this new method, challenging non-linear control problems can be made tractable, and simple, and practical solutions may be created for a broad class of control systems and products.\r\n\r\nAccording to Koopman, an autonomous, nonlinear dynamical system can be represented as a linear system in an infinite dimensional space. The theory guarantees the exact linearization, but it is not applicable to systems with active control inputs, and the number of variables must be truncated to a finite dimensional system for practical use. Furthermore, the original theory does not state how to find additional variables, called observables, to represent a nonlinear system in the lifted space, where the system behaves linearly. Here, we will establish a systematic way of finding effective observables based on physical modeling theory, namely, Bond Graphs modeling. Given the physical connectivity of system elements, a special class of observables, called auxiliary variables, are defined. Two linear state equations, one for state variables and the other for auxiliary variables, represent the nonlinear dynamics in the lifted space. This is known as Dual-Faceted (DF) Linearization. These auxiliary variables possess clear physical meanings, and use of these auxiliary variables for linear feedback can better inform the controller and outperforms its counterpart. If the auxiliary variables, or part of them, are physically measurable, the linear model can be identified through a data-driven sub-space method. The DF Linearization is particularly useful for nonlinear Model Predictive Control (MPC), where the linear model in the lifted space provides an accurate approximation over a finite time horizon and reduces the original nonlinear MPC to a linear MPC. The optimization problem becomes convex and the computation time drastically reduces.\r\n\r\nThis award reflects NSF's statutory mission and has been deemed worthy of support through evaluation using the Foundation's intellectual merit and broader impacts review criteria.",
 "awd_arra_amount": 0.0,
 "dir_abbr": "ENG",
 "org_dir_long_name": "Directorate for Engineering",
 "div_abbr": "CMMI",
 "org_div_long_name": "Division of Civil, Mechanical, and Manufacturing Innovation",
 "awd_agcy_code": "4900",
 "fund_agcy_code": "4900",
 "pi": [
  {
   "pi_role": "Principal Investigator",
   "pi_first_name": "Haruhiko",
   "pi_last_name": "Asada",
   "pi_mid_init": "H",
   "pi_sufx_name": "",
   "pi_full_name": "Haruhiko H Asada",
   "pi_email_addr": "asada@mit.edu",
   "nsf_id": "000207312",
   "pi_start_date": "2020-08-20",
   "pi_end_date": null
  }
 ],
 "inst": {
  "inst_name": "Massachusetts Institute of Technology",
  "inst_street_address": "77 MASSACHUSETTS AVE",
  "inst_street_address_2": "",
  "inst_city_name": "CAMBRIDGE",
  "inst_state_code": "MA",
  "inst_state_name": "Massachusetts",
  "inst_phone_num": "6172531000",
  "inst_zip_code": "021394301",
  "inst_country_name": "United States",
  "cong_dist_code": "07",
  "st_cong_dist_code": "MA07",
  "org_lgl_bus_name": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY",
  "org_prnt_uei_num": "E2NYLCDML6V1",
  "org_uei_num": "E2NYLCDML6V1"
 },
 "perf_inst": {
  "perf_inst_name": "Massachusetts Institute of Technology",
  "perf_str_addr": "77 Massachusetts Ave.",
  "perf_city_name": "Cambridge",
  "perf_st_code": "MA",
  "perf_st_name": "Massachusetts",
  "perf_zip_code": "021394307",
  "perf_ctry_code": "US",
  "perf_cong_dist": "07",
  "perf_st_cong_dist": "MA07",
  "perf_ctry_name": "United States",
  "perf_ctry_flag": "1"
 },
 "pgm_ele": [
  {
   "pgm_ele_code": "756900",
   "pgm_ele_name": "Dynamics, Control and System D"
  }
 ],
 "pgm_ref": [
  {
   "pgm_ref_code": "030E",
   "pgm_ref_txt": "CONTROL SYSTEMS"
  },
  {
   "pgm_ref_code": "034E",
   "pgm_ref_txt": "Dynamical systems"
  }
 ],
 "app_fund": [
  {
   "app_code": "0120",
   "app_name": "NSF RESEARCH & RELATED ACTIVIT",
   "app_symb_id": "040100",
   "fund_code": "01002021DB",
   "fund_name": "NSF RESEARCH & RELATED ACTIVIT",
   "fund_symb_id": "040100"
  }
 ],
 "oblg_fy": [
  {
   "fund_oblg_fiscal_yr": 2020,
   "fund_oblg_amt": 478947.0
  }
 ],
 "por": {
  "por_cntn": "<div class=\"porColContainerWBG\">\n<div class=\"porContentCol\"><p>Linear systems are easy to deal with. Many mathematical tools are available for analyzing and manipulating the system. In contrast, nonlinear systems are more complex, for which available tools are limited. This project addresses how nonlinear systems can be converted to linear systems, so that complex nonlinear systems can be more easily dealt with. The underpinning theory was created about 100 years ago by Bernard Koopman.</p>\r\n<p>Suppose that you are observing the behavior of a nonlinear system, say a biped robot walking on a floor, with your eyes. Also suppose that many other people, too, are observing the same nonlinear system with their eyes from their angles. See Figure 1. If all the observations are collected to create a snapshot view of the nonlinear system, it can be shown that the behavior delineated with the collected observations looks closer to that of a linear system. Koopman said that, as the number of different observations, called observables, tends to infinity, the original nonlinear behavior approaches a linear behavior in high-dimensional space. This linear representation is valid not only near a single point but is also accurate globally. This sounds mysterious, but it can be demystified in a simple manner.</p>\r\n<p>Consider Fourier Series Expansion of a function. The function can be represented as a series of sines and cosines with some coefficients. Treat the individual sine and cosine functions as the eyes observing the nonlinear system. Putting all the observables into one gigantic vector, we can represent the current state of the nonlinear system.</p>\r\n<p>We want to predict how this nonlinear system varies over time. Let us observe the nonlinear system, say 1 second later. These new observations reflect the transition of the original nonlinear system from the previous state; therefore, they are functions of the previous state. Take Fourier Series Expansion of these functions representing the state after the transition. The Fourier Series manifests that the new state is represented as a series of sine and cosine terms, namely a linear combination of many observables. Therefore, we can represent the transition of the nonlinear system as a linear expression, when viewed from the infinitely many observable eyes. We can convert a nonlinear system to a linear system by using many observables. Observable functions do not have to be sines and cosines but can be broad functions, including neural networks derived from data.</p>\r\n<p>This Koopman Operator theory has been applied to various areas, including system dynamics and control, robotics, machine learning, computer vision, and fluid mechanics. Although promising applications have been reported, fundamental limitations still exist that prevent the Koopman operator from being properly applied to practical problems. The most critical outcome of this NSF project is that we have removed one of the critical barriers and extended the applicability of the Koopman operator theory to broader engineered systems that we want to operate.</p>\r\n<p>The original Koopman theory is applicable only to systems with no control input, called autonomous systems. We have removed this limitation and made it applicable to general engineered systems with control. Note that engineered systems like robots, cars, aircraft, power plants, etc. are all non-autonomous systems with control inputs. The Koopman operator is now correctly applied to many of these engineered systems. The key to this successful extension of the theory is to include the dynamics of the actuators involved in the system. We have found that control input terms appear linearly in the governing equations of the actuator dynamics. Using this property, we can obtain a Koopman operator for the non-autonomous system by obtaining the Koopman operator of the associated autonomous systems and superposing the control input terms to the autonomous system. See Figure 2. We have applied this method, called Control-Coherent Koopman modeling, to multi-link robot arms, legged robots, multi-cable cranes (Figure 3), and push manipulation robots.</p>\r\n<p>We have also made three other important accomplishments. One is to calculate Koopman operators directly from nonlinear state equations &ndash; called Direct Koopman Encoding. Second, we have established a systematic method for finding an effective set of observable functions based on physical system modeling theory. With a special class of embedding functions, which are the outputs of constitutive laws of nonlinear elements called auxiliary variables, the state equations can be expressed as linear time-invariant systems. See Figure 4. Finally, we have proposed to apply the Koopman operator to systems with multiple governing equations that must be switched. A legged robot, for example, switches between multiple equations of motion as the robot legs make and break contact with the floor. See Figure 5. This type of switched systems is difficult to analyze and control, but Koopman operators can represent the segmented dynamical systems with one unified model that is globally valid. See Figure 6.</p>\r\n<p>&nbsp;</p><br>\n<p>\n Last Modified: 12/27/2024<br>\nModified by: Haruhiko&nbsp;H&nbsp;Asada</p></div>\n<div class=\"porSideCol\"\n><div class=\"each-gallery\">\n<div class=\"galContent\" id=\"gallery0\">\n<div class=\"photoCount\" id=\"photoCount0\">\n\t\t\t\t\t\t\t\t\tImages (<span id=\"selectedPhoto0\">1</span> of <span class=\"totalNumber\"></span>)\t\n\t\t\t\t\t\t\t\t</div>\n<div class=\"galControls onePhoto\" id=\"controls0\"></div>\n<div class=\"galSlideshow\" id=\"slideshow0\"></div>\n<div class=\"galEmbox\" id=\"embox\">\n<div class=\"image-title\"></div>\n</div>\n</div>\n<div class=\"galNavigation\" id=\"navigation0\">\n<ul class=\"thumbs\" id=\"thumbs0\">\n<li>\n<a href=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735316029681_Slide4--rgov-214x142.jpeg\" original=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735316029681_Slide4--rgov-800width.jpeg\" title=\"Figure 4 Multi cable manipulation\"><img src=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735316029681_Slide4--rgov-66x44.jpeg\" alt=\"Figure 4 Multi cable manipulation\"></a>\n<div class=\"imageCaptionContainer\">\n<div class=\"imageCaption\">The dynamics of multi-cable manipulation is complex. Each cable switched between slack and taut states, and the 4 different equations must be switched. The Koopman operator theory allows us to represent them with one linear state equation.</div>\n<div class=\"imageCredit\">Haruhiko Harry Asada</div>\n<div class=\"imagePermisssions\">Royalty-free (unrestricted use)</div>\n<div class=\"imageSubmitted\">Haruhiko&nbsp;H&nbsp;Asada\n<div class=\"imageTitle\">Figure 4 Multi cable manipulation</div>\n</div>\n</li><li>\n<a href=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735315661847_Slide3--rgov-214x142.jpeg\" original=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735315661847_Slide3--rgov-800width.jpeg\" title=\"Figure 3 Dual Faceted Linearization using Auxiliary Variables\"><img src=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735315661847_Slide3--rgov-66x44.jpeg\" alt=\"Figure 3 Dual Faceted Linearization using Auxiliary Variables\"></a>\n<div class=\"imageCaptionContainer\">\n<div class=\"imageCaption\">Based on physical system modeling, e.g. Bond Graph, effective observables can be obtained. Dual Faceted Linearization uses outputs of all the nonlinear elements involved in a nonlinear system (auxiliary variables) as observables. With these embeddings, the state equation becomes linear.</div>\n<div class=\"imageCredit\">Haruhiko Harry Asada</div>\n<div class=\"imagePermisssions\">Copyrighted</div>\n<div class=\"imageSubmitted\">Haruhiko&nbsp;H&nbsp;Asada\n<div class=\"imageTitle\">Figure 3 Dual Faceted Linearization using Auxiliary Variables</div>\n</div>\n</li><li>\n<a href=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735315226390_Slide2--rgov-214x142.jpeg\" original=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735315226390_Slide2--rgov-800width.jpeg\" title=\"Figure 2 Principle of Control-Coherent Koopman modeling\"><img src=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735315226390_Slide2--rgov-66x44.jpeg\" alt=\"Figure 2 Principle of Control-Coherent Koopman modeling\"></a>\n<div class=\"imageCaptionContainer\">\n<div class=\"imageCaption\">This algorithm extends the Koopman operator theory to non-autonomous systems with control. Obtain a Koopman operator for the autonomous system with no control. Next, superpose the control input terms to the Koopman operator of the autonomous system. Actuator dynamics must have independent state.</div>\n<div class=\"imageCredit\">Haruhiko Harry Asada</div>\n<div class=\"imagePermisssions\">Royalty-free (restricted use - cannot be shared)</div>\n<div class=\"imageSubmitted\">Haruhiko&nbsp;H&nbsp;Asada\n<div class=\"imageTitle\">Figure 2 Principle of Control-Coherent Koopman modeling</div>\n</div>\n</li><li>\n<a href=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735316600004_Slide5--rgov-214x142.jpeg\" original=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735316600004_Slide5--rgov-800width.jpeg\" title=\"Figure 5 Control-Coherent Koopman modeling of an active rimless wheel on a compliant floor\"><img src=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735316600004_Slide5--rgov-66x44.jpeg\" alt=\"Figure 5 Control-Coherent Koopman modeling of an active rimless wheel on a compliant floor\"></a>\n<div class=\"imageCaptionContainer\">\n<div class=\"imageCaption\">The rimless wheel is a simplified model of biped walk. Two dynamic equations are switched as legs make and break contact with the floor. Control-Coherent Koopman model can be constructed to represent the switched dynamics with one linear state equation to which Model Predictive Control is applied.</div>\n<div class=\"imageCredit\">Haruhiko Harry Asada</div>\n<div class=\"imagePermisssions\">Royalty-free (restricted use - cannot be shared)</div>\n<div class=\"imageSubmitted\">Haruhiko&nbsp;H&nbsp;Asada\n<div class=\"imageTitle\">Figure 5 Control-Coherent Koopman modeling of an active rimless wheel on a compliant floor</div>\n</div>\n</li><li>\n<a href=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735314744056_Slide1--rgov-214x142.jpeg\" original=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735314744056_Slide1--rgov-800width.jpeg\" title=\"Koopman Operator in a Nutshell\"><img src=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735314744056_Slide1--rgov-66x44.jpeg\" alt=\"Koopman Operator in a Nutshell\"></a>\n<div class=\"imageCaptionContainer\">\n<div class=\"imageCaption\">A nonlinear system can be represented as a linear system when viewed from infinitely many observables. Putting together all the observables in a vector, we can construct a snapshot view of the nonlinear system, which makes a linear transition as the original nonlinear system moves to a next state.</div>\n<div class=\"imageCredit\">Haruhiko Harry Asada</div>\n<div class=\"imagePermisssions\">Royalty-free (unrestricted use)</div>\n<div class=\"imageSubmitted\">Haruhiko&nbsp;H&nbsp;Asada\n<div class=\"imageTitle\">Koopman Operator in a Nutshell</div>\n</div>\n</li><li>\n<a href=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735316989540_Slide6--rgov-214x142.jpeg\" original=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735316989540_Slide6--rgov-800width.jpeg\" title=\"Figure 6 Global, unified representation of nonlinear systems with segmented dynamics\"><img src=\"/por/images/Reports/POR/2024/2021625/2021625_10700073_1735316989540_Slide6--rgov-66x44.jpeg\" alt=\"Figure 6 Global, unified representation of nonlinear systems with segmented dynamics\"></a>\n<div class=\"imageCaptionContainer\">\n<div class=\"imageCaption\">Switched systems are difficult to analyze and control due to switching between multiple dynamic equations. Koopman operator allows us to replace those segmented dynamics by a single unified linear model that is globally valid.</div>\n<div class=\"imageCredit\">Haruhiko Harry Asada</div>\n<div class=\"imagePermisssions\">Copyrighted</div>\n<div class=\"imageSubmitted\">Haruhiko&nbsp;H&nbsp;Asada\n<div class=\"imageTitle\">Figure 6 Global, unified representation of nonlinear systems with segmented dynamics</div>\n</div>\n</li></ul>\n</div>\n</div></div>\n</div>\n",
  "por_txt_cntn": "\n\nLinear systems are easy to deal with. Many mathematical tools are available for analyzing and manipulating the system. In contrast, nonlinear systems are more complex, for which available tools are limited. This project addresses how nonlinear systems can be converted to linear systems, so that complex nonlinear systems can be more easily dealt with. The underpinning theory was created about 100 years ago by Bernard Koopman.\r\n\n\nSuppose that you are observing the behavior of a nonlinear system, say a biped robot walking on a floor, with your eyes. Also suppose that many other people, too, are observing the same nonlinear system with their eyes from their angles. See Figure 1. If all the observations are collected to create a snapshot view of the nonlinear system, it can be shown that the behavior delineated with the collected observations looks closer to that of a linear system. Koopman said that, as the number of different observations, called observables, tends to infinity, the original nonlinear behavior approaches a linear behavior in high-dimensional space. This linear representation is valid not only near a single point but is also accurate globally. This sounds mysterious, but it can be demystified in a simple manner.\r\n\n\nConsider Fourier Series Expansion of a function. The function can be represented as a series of sines and cosines with some coefficients. Treat the individual sine and cosine functions as the eyes observing the nonlinear system. Putting all the observables into one gigantic vector, we can represent the current state of the nonlinear system.\r\n\n\nWe want to predict how this nonlinear system varies over time. Let us observe the nonlinear system, say 1 second later. These new observations reflect the transition of the original nonlinear system from the previous state; therefore, they are functions of the previous state. Take Fourier Series Expansion of these functions representing the state after the transition. The Fourier Series manifests that the new state is represented as a series of sine and cosine terms, namely a linear combination of many observables. Therefore, we can represent the transition of the nonlinear system as a linear expression, when viewed from the infinitely many observable eyes. We can convert a nonlinear system to a linear system by using many observables. Observable functions do not have to be sines and cosines but can be broad functions, including neural networks derived from data.\r\n\n\nThis Koopman Operator theory has been applied to various areas, including system dynamics and control, robotics, machine learning, computer vision, and fluid mechanics. Although promising applications have been reported, fundamental limitations still exist that prevent the Koopman operator from being properly applied to practical problems. The most critical outcome of this NSF project is that we have removed one of the critical barriers and extended the applicability of the Koopman operator theory to broader engineered systems that we want to operate.\r\n\n\nThe original Koopman theory is applicable only to systems with no control input, called autonomous systems. We have removed this limitation and made it applicable to general engineered systems with control. Note that engineered systems like robots, cars, aircraft, power plants, etc. are all non-autonomous systems with control inputs. The Koopman operator is now correctly applied to many of these engineered systems. The key to this successful extension of the theory is to include the dynamics of the actuators involved in the system. We have found that control input terms appear linearly in the governing equations of the actuator dynamics. Using this property, we can obtain a Koopman operator for the non-autonomous system by obtaining the Koopman operator of the associated autonomous systems and superposing the control input terms to the autonomous system. See Figure 2. We have applied this method, called Control-Coherent Koopman modeling, to multi-link robot arms, legged robots, multi-cable cranes (Figure 3), and push manipulation robots.\r\n\n\nWe have also made three other important accomplishments. One is to calculate Koopman operators directly from nonlinear state equations  called Direct Koopman Encoding. Second, we have established a systematic method for finding an effective set of observable functions based on physical system modeling theory. With a special class of embedding functions, which are the outputs of constitutive laws of nonlinear elements called auxiliary variables, the state equations can be expressed as linear time-invariant systems. See Figure 4. Finally, we have proposed to apply the Koopman operator to systems with multiple governing equations that must be switched. A legged robot, for example, switches between multiple equations of motion as the robot legs make and break contact with the floor. See Figure 5. This type of switched systems is difficult to analyze and control, but Koopman operators can represent the segmented dynamical systems with one unified model that is globally valid. See Figure 6.\r\n\n\n\t\t\t\t\tLast Modified: 12/27/2024\n\n\t\t\t\t\tSubmitted by: HaruhikoHAsada\n"
 }
}