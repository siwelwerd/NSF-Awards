{
 "awd_id": "2022349",
 "agcy_id": "NSF",
 "tran_type": "Grant",
 "awd_istr_txt": "Standard Grant",
 "awd_titl_txt": "SBIR Phase I:  Reinforcement Learning for Guidance and Control of Spacecraft",
 "cfda_num": "47.084",
 "org_code": "15030000",
 "po_phone": null,
 "po_email": "",
 "po_sign_block_name": "Anna Brady-Estevez",
 "awd_eff_date": "2020-08-01",
 "awd_exp_date": "2021-12-31",
 "tot_intn_awd_amt": 256000.0,
 "awd_amount": 256000.0,
 "awd_min_amd_letter_date": "2020-08-04",
 "awd_max_amd_letter_date": "2020-08-04",
 "awd_abstract_narration": "The broader impact/commercial potential of this Small Business Innovation Research (SBIR) Phase I project is a coupled guidance and control flight software solution that enables multi-spacecraft systems to be truly autonomous in their station-keeping and self-distribution. The proposed innovation is for a deep reinforcement learning (DRL) agent to learn how to autonomously determine and command maneuvers that yield a desired spacecraft formation. The proposed project could reduce customers\u2019 cost of operations by removing humans from the closed loop control system. The proposed innovation scales to systems of large numbers of spacecraft without scaling the cost of flight operations. Other potential benefits to customers are risk reductions: a DRL agent does not require an exact model of spacecraft subsystems and orbital dynamics and can learn in real-time, thus being robust to off-nominal system performance and unexpected perturbations. Benefits of this project may include a DRL agent discovering novel guidance and control solutions for mission designs that are not known from legacy orbital dynamics approaches. Potential broader societal impacts include enabling Deep Space Gateway operations and science missions to sample in-situ, simultaneous measurements over a large area, resulting in valuable science data returns for research or commercial applications in Earth orbit or deep space.\r\n\r\nThis Small Business Innovation Research Phase I project will demonstrate the technical feasibility of implementing DRL as a solution for truly autonomous spacecraft guidance and control. The challenge motivating this project is the control of multi-spacecraft systems, where maneuver planning is neither intuitive nor straightforward due to the nonlinear equations of relative motion. Historically, solutions are found by making simplifying assumptions of circular orbits and linearized equations of relative motion. Such assumptions are avoided in this research plan. The primary research objective is to train a DRL agent using the high-fidelity model of NASA\u2019s General Mission Analysis Tool (GMAT). First, the problem of achieving a particular formation or distribution will be formulated as a Markov Decision Process. Next, software infrastructure will be developed using TensorFlow, Python, and GMAT. Within this framework, the DRL agent will be trained to learn a policy that maneuvers the spacecraft into a specified formation, subject to operations constraints like available propellant and actuation limits. Anticipated technical results include comparisons of on-policy versus off-policy approaches to achieving coordinated spacecraft mission, demonstration of the technical feasibility of DRL-based flight software for guidance and control, and a characterization of the limitations of DRL-based control.\r\n\r\nThis award reflects NSF's statutory mission and has been deemed worthy of support through evaluation using the Foundation's intellectual merit and broader impacts review criteria.",
 "awd_arra_amount": 0.0,
 "dir_abbr": "TIP",
 "org_dir_long_name": "Directorate for Technology, Innovation, and Partnerships",
 "div_abbr": "TI",
 "org_div_long_name": "Translational Impacts",
 "awd_agcy_code": "4900",
 "fund_agcy_code": "4900",
 "pi": [
  {
   "pi_role": "Principal Investigator",
   "pi_first_name": "Tracie",
   "pi_last_name": "Conn",
   "pi_mid_init": "R",
   "pi_sufx_name": "",
   "pi_full_name": "Tracie R Conn",
   "pi_email_addr": "tracie@orbital-ai.com",
   "nsf_id": "000820937",
   "pi_start_date": "2020-08-04",
   "pi_end_date": null
  }
 ],
 "inst": {
  "inst_name": "ORBITAL AI LLC",
  "inst_street_address": "903 S ROSEDALE CT",
  "inst_street_address_2": "",
  "inst_city_name": "GROSSE POINTE WOODS",
  "inst_state_code": "MI",
  "inst_state_name": "Michigan",
  "inst_phone_num": "5129139202",
  "inst_zip_code": "482361165",
  "inst_country_name": "United States",
  "cong_dist_code": "13",
  "st_cong_dist_code": "MI13",
  "org_lgl_bus_name": "ORBITAL AI LLC",
  "org_prnt_uei_num": "",
  "org_uei_num": "YU7RXJXLEFK6"
 },
 "perf_inst": {
  "perf_inst_name": "ORBITAL AI LLC",
  "perf_str_addr": "903 S Rosedale Ct",
  "perf_city_name": "Grosse Pointe Woods",
  "perf_st_code": "MI",
  "perf_st_name": "Michigan",
  "perf_zip_code": "482361165",
  "perf_ctry_code": "US",
  "perf_cong_dist": "13",
  "perf_st_cong_dist": "MI13",
  "perf_ctry_name": "United States",
  "perf_ctry_flag": "1"
 },
 "pgm_ele": [
  {
   "pgm_ele_code": "537100",
   "pgm_ele_name": "SBIR Phase I"
  }
 ],
 "pgm_ref": [
  {
   "pgm_ref_code": "092E",
   "pgm_ref_txt": "Control systems & applications"
  },
  {
   "pgm_ref_code": "4080",
   "pgm_ref_txt": "ADVANCED COMP RESEARCH PROGRAM"
  }
 ],
 "app_fund": [
  {
   "app_code": "0120",
   "app_name": "NSF RESEARCH & RELATED ACTIVIT",
   "app_symb_id": "040100",
   "fund_code": "01002021DB",
   "fund_name": "NSF RESEARCH & RELATED ACTIVIT",
   "fund_symb_id": "040100"
  }
 ],
 "oblg_fy": [
  {
   "fund_oblg_fiscal_yr": 2020,
   "fund_oblg_amt": 256000.0
  }
 ],
 "por": {
  "por_cntn": "<div class=\"porColContainerWBG\">\n<div class=\"porContentCol\"><p>The objective of the project was to design, train, and test a Deep Reinforcement Learning (DRL) agent to achieve swarm formation flying missions. DRL is a type of Machine Learning (ML) where we seek to train an agent to achieve a goal. We followed the standard Markov Decision Process framework and designed a spacecraft simulation test environment, DRL agent algorithms, and overarching Jupyter notebooks that managed training and testing our models. We designed and implemented several reward signals for various swarm mode types, ranging from a simple target-chaser mode to a more complicated &ldquo;fishbowl&rdquo; swarm. The software modules and process flowchart that we designed are shown in Figure 1. The pseudocode flowchart for how the DRL agent gains experience in the simulated environment is shown in Figure 2 and the pseudocode for how models are trained and tested is shown in Figure 3.</p>\n<p><br />Central to this project was the design and implementation of the DRL agent itself. Feedback from our customer interviews dictated the use of deterministic policies for predictable actions. We applied two state-of-the-art actor/critic network models: Deep Deterministic Policy Gradient (DDPG), and Twin Delayed Deep Deterministic Policy Gradients (TD3). Both model types were tested extensively and hyperparameters were tuned via ablation studies. We followed software best practices including: GitHub repo for version control of source code, adherence to a coding standard, documentation, package management with Conda, etc.</p>\n<p><br />Analysis of our prototype DRL models confirms that the agent is able to &ldquo;learn&rdquo; the maneuvers to complete a Hohmann transfer orbit. While this orbit has a well known solution in orbital mechanics, <span style=\"text-decoration: underline;\"><em>it demonstrates that a machine learning algorithm &ldquo;finds&rdquo; the solution we know to be optimal, without prior knowledge of the physics of spacecraft dynamics or knowledge of the oblate Earth&rsquo;s gravitational field. </em></span>A Monte Carlo simulation study was performed to evaluate the performance of the trained agent. The initial location of the spacecraft on the starting circular orbit was sampled from a uniform distribution to conduct 50,000 simulation runs. Our results show that the agent is able to conduct the orbit transfer within the tolerances set during training 100% of the time. This gave confidence that our framework and source code is appropriate for studying more complex spacecraft swarm guidance and control scenarios.</p>\n<p><br />The fishbowl swarm configuration is defined as multiple spacecraft moving around a defined &ldquo;center&rdquo; spacecraft, where the spacecraft can drift in relative motion but must stay within a defined radius from the center of the swarm. The spacecraft must make maneuvers to stay within this defined virtual boundary, but cannot move so close to another spacecraft as to risk collision. We performed numerous ablation studies to optimize the performance of the DRL agent to control a fishbowl swarm, both with the DDPG and TD3 approaches. Results of our initial ablation studies demonstrate that our first prototype guidance and control models have success for simpler spacecraft swarm configurations. As the number of spacecraft and constraints increase, however, simulations show the agent has a more difficult time &ldquo;learning&rdquo; the desired goal. Training can be unstable or take millions of experiences to gain traction. Applying state-of-the-art techniques, such as normalization and hindsight experience replay, may improve performance, but extensive ablation studies are still required to find the optimal hyperparameters and network architectures to manage larger spacecraft swarm systems.</p>\n<p><br />Another outcome from this project included clearer understanding of customers' needs. Customers want more than a modular guidance and control software system; they are looking towards future missions where the multi-spacecraft system is &ldquo;truly intelligent,&rdquo; where the system can self-diagnose problems, be self-reliant, react to real-time in-situ conditions, coordinate to perform a commanded task, and be commanded by other AI-based models to optimize data collection, all without intervention from human flight controllers on Earth. Customers are not interested in discussing the many interesting and novel algorithms that exist only in the research/academic space. Rather, customers require that ML solutions are demonstrated to perform on the computationally constrained compute platforms of CubeSats. Therefore, performance for any ML product we develop must be demonstrated on a &ldquo;digital twin&rdquo; with testing, validation and verification in high-fidelity simulation.</p>\n<p><br />Our assumption that customers wanted a software application that runs autonomously onboard the spacecraft was incorrect. There are several use cases where customers would be happy with an autonomous guidance and control system that runs on computers on the ground (i.e. at the mission operations center). The tool could be used throughout the mission design and planning process, and then run on the ground during real-time mission operations. In fact, humans-in-the-loop would be acceptable for initial verification or even for the delivered product, if it meant that the maneuver planning process could be sped up faster than what is required today.</p>\n<p>&nbsp;</p><br>\n<p>\n Last Modified: 02/06/2024<br>\nModified by: Tracie&nbsp;R&nbsp;Conn</p></div>\n<div class=\"porSideCol\"\n><div class=\"each-gallery\">\n<div class=\"galContent\" id=\"gallery0\">\n<div class=\"photoCount\" id=\"photoCount0\">\n\t\t\t\t\t\t\t\t\tImages (<span id=\"selectedPhoto0\">1</span> of <span class=\"totalNumber\"></span>)\t\n\t\t\t\t\t\t\t\t</div>\n<div class=\"galControls onePhoto\" id=\"controls0\"></div>\n<div class=\"galSlideshow\" id=\"slideshow0\"></div>\n<div class=\"galEmbox\" id=\"embox\">\n<div class=\"image-title\"></div>\n</div>\n</div>\n<div class=\"galNavigation\" id=\"navigation0\">\n<ul class=\"thumbs\" id=\"thumbs0\">\n<li>\n<a href=\"/por/images/Reports/POR/2024/2022349/2022349_10692735_1707278452261_Figure_3_Training_Testing_Pseudocode--rgov-214x142.png\" original=\"/por/images/Reports/POR/2024/2022349/2022349_10692735_1707278452261_Figure_3_Training_Testing_Pseudocode--rgov-800width.png\" title=\"Model Training and Testing Pseudocode\"><img src=\"/por/images/Reports/POR/2024/2022349/2022349_10692735_1707278452261_Figure_3_Training_Testing_Pseudocode--rgov-66x44.png\" alt=\"Model Training and Testing Pseudocode\"></a>\n<div class=\"imageCaptionContainer\">\n<div class=\"imageCaption\">The pseudocode for how models are trained and tested is shown in Figure 3.</div>\n<div class=\"imageCredit\">Tracie Conn</div>\n<div class=\"imagePermisssions\">Public Domain</div>\n<div class=\"imageSubmitted\">Tracie&nbsp;R&nbsp;Conn\n<div class=\"imageTitle\">Model Training and Testing Pseudocode</div>\n</div>\n</li><li>\n<a href=\"/por/images/Reports/POR/2024/2022349/2022349_10692735_1707278397459_Figure_2_GMAT_sat_state_propagation_for_MDP_flowchart--rgov-214x142.jpg\" original=\"/por/images/Reports/POR/2024/2022349/2022349_10692735_1707278397459_Figure_2_GMAT_sat_state_propagation_for_MDP_flowchart--rgov-800width.jpg\" title=\"GMAT satellite state propagation for MDP flowchart\"><img src=\"/por/images/Reports/POR/2024/2022349/2022349_10692735_1707278397459_Figure_2_GMAT_sat_state_propagation_for_MDP_flowchart--rgov-66x44.jpg\" alt=\"GMAT satellite state propagation for MDP flowchart\"></a>\n<div class=\"imageCaptionContainer\">\n<div class=\"imageCaption\">The pseudocode flowchart for how the DRL agent gains experience in the simulated environment is shown in Figure 2.</div>\n<div class=\"imageCredit\">Tracie Conn</div>\n<div class=\"imagePermisssions\">Public Domain</div>\n<div class=\"imageSubmitted\">Tracie&nbsp;R&nbsp;Conn\n<div class=\"imageTitle\">GMAT satellite state propagation for MDP flowchart</div>\n</div>\n</li><li>\n<a href=\"/por/images/Reports/POR/2024/2022349/2022349_10692735_1707278336028_Figure_1_Training_and_Testing_in_Simulation_Flow_Chart--rgov-214x142.jpg\" original=\"/por/images/Reports/POR/2024/2022349/2022349_10692735_1707278336028_Figure_1_Training_and_Testing_in_Simulation_Flow_Chart--rgov-800width.jpg\" title=\"Training and Testing in Simulation Flow Chart\"><img src=\"/por/images/Reports/POR/2024/2022349/2022349_10692735_1707278336028_Figure_1_Training_and_Testing_in_Simulation_Flow_Chart--rgov-66x44.jpg\" alt=\"Training and Testing in Simulation Flow Chart\"></a>\n<div class=\"imageCaptionContainer\">\n<div class=\"imageCaption\">The software modules and process flowchart that we designed are shown in Figure 1.</div>\n<div class=\"imageCredit\">Tracie Conn</div>\n<div class=\"imagePermisssions\">Public Domain</div>\n<div class=\"imageSubmitted\">Tracie&nbsp;R&nbsp;Conn\n<div class=\"imageTitle\">Training and Testing in Simulation Flow Chart</div>\n</div>\n</li></ul>\n</div>\n</div></div>\n</div>\n",
  "por_txt_cntn": "\n\nThe objective of the project was to design, train, and test a Deep Reinforcement Learning (DRL) agent to achieve swarm formation flying missions. DRL is a type of Machine Learning (ML) where we seek to train an agent to achieve a goal. We followed the standard Markov Decision Process framework and designed a spacecraft simulation test environment, DRL agent algorithms, and overarching Jupyter notebooks that managed training and testing our models. We designed and implemented several reward signals for various swarm mode types, ranging from a simple target-chaser mode to a more complicated fishbowl swarm. The software modules and process flowchart that we designed are shown in Figure 1. The pseudocode flowchart for how the DRL agent gains experience in the simulated environment is shown in Figure 2 and the pseudocode for how models are trained and tested is shown in Figure 3.\n\n\n\nCentral to this project was the design and implementation of the DRL agent itself. Feedback from our customer interviews dictated the use of deterministic policies for predictable actions. We applied two state-of-the-art actor/critic network models: Deep Deterministic Policy Gradient (DDPG), and Twin Delayed Deep Deterministic Policy Gradients (TD3). Both model types were tested extensively and hyperparameters were tuned via ablation studies. We followed software best practices including: GitHub repo for version control of source code, adherence to a coding standard, documentation, package management with Conda, etc.\n\n\n\nAnalysis of our prototype DRL models confirms that the agent is able to learn the maneuvers to complete a Hohmann transfer orbit. While this orbit has a well known solution in orbital mechanics, it demonstrates that a machine learning algorithm finds the solution we know to be optimal, without prior knowledge of the physics of spacecraft dynamics or knowledge of the oblate Earths gravitational field. A Monte Carlo simulation study was performed to evaluate the performance of the trained agent. The initial location of the spacecraft on the starting circular orbit was sampled from a uniform distribution to conduct 50,000 simulation runs. Our results show that the agent is able to conduct the orbit transfer within the tolerances set during training 100% of the time. This gave confidence that our framework and source code is appropriate for studying more complex spacecraft swarm guidance and control scenarios.\n\n\n\nThe fishbowl swarm configuration is defined as multiple spacecraft moving around a defined center spacecraft, where the spacecraft can drift in relative motion but must stay within a defined radius from the center of the swarm. The spacecraft must make maneuvers to stay within this defined virtual boundary, but cannot move so close to another spacecraft as to risk collision. We performed numerous ablation studies to optimize the performance of the DRL agent to control a fishbowl swarm, both with the DDPG and TD3 approaches. Results of our initial ablation studies demonstrate that our first prototype guidance and control models have success for simpler spacecraft swarm configurations. As the number of spacecraft and constraints increase, however, simulations show the agent has a more difficult time learning the desired goal. Training can be unstable or take millions of experiences to gain traction. Applying state-of-the-art techniques, such as normalization and hindsight experience replay, may improve performance, but extensive ablation studies are still required to find the optimal hyperparameters and network architectures to manage larger spacecraft swarm systems.\n\n\n\nAnother outcome from this project included clearer understanding of customers' needs. Customers want more than a modular guidance and control software system; they are looking towards future missions where the multi-spacecraft system is truly intelligent, where the system can self-diagnose problems, be self-reliant, react to real-time in-situ conditions, coordinate to perform a commanded task, and be commanded by other AI-based models to optimize data collection, all without intervention from human flight controllers on Earth. Customers are not interested in discussing the many interesting and novel algorithms that exist only in the research/academic space. Rather, customers require that ML solutions are demonstrated to perform on the computationally constrained compute platforms of CubeSats. Therefore, performance for any ML product we develop must be demonstrated on a digital twin with testing, validation and verification in high-fidelity simulation.\n\n\n\nOur assumption that customers wanted a software application that runs autonomously onboard the spacecraft was incorrect. There are several use cases where customers would be happy with an autonomous guidance and control system that runs on computers on the ground (i.e. at the mission operations center). The tool could be used throughout the mission design and planning process, and then run on the ground during real-time mission operations. In fact, humans-in-the-loop would be acceptable for initial verification or even for the delivered product, if it meant that the maneuver planning process could be sped up faster than what is required today.\n\n\n\t\t\t\t\tLast Modified: 02/06/2024\n\n\t\t\t\t\tSubmitted by: TracieRConn\n"
 }
}