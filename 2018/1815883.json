{
 "awd_id": "1815883",
 "agcy_id": "NSF",
 "tran_type": "Grant",
 "awd_istr_txt": "Standard Grant",
 "awd_titl_txt": "SaTC: STARSS: Small: Domain Informed Techniques for Detecting and Defending Against Malicious Firmware",
 "cfda_num": "47.070",
 "org_code": "05050000",
 "po_phone": null,
 "po_email": "",
 "po_sign_block_name": "James Joshi",
 "awd_eff_date": "2018-08-15",
 "awd_exp_date": "2022-12-31",
 "tot_intn_awd_amt": 333328.0,
 "awd_amount": 333328.0,
 "awd_min_amd_letter_date": "2018-08-09",
 "awd_max_amd_letter_date": "2018-08-09",
 "awd_abstract_narration": "Embedded systems play a large role in our daily lives. They are found in everything from computers and consumer electronics to appliances and automobiles, and represent a market estimated to be worth almost $160 billion. Many of them, however, use inexpensive microcontrollers that cannot easily be analyzed, so it is unclear how well they operate in practice. This work seeks improve the safety and security of these systems by developing techniques to analyze their firmware, particularly with regards to the popular Universal Serial Bus (USB) and Bluetooth protocols.\r\n\r\nThis project will involve development of a platform for allowing firmware analysis of these common but overlooked microcontroller architectures. The goal is to validate the security of critical communications on these embedded devices. The project builds on three research thrusts: 1) Formal modeling of the USB and Bluetooth protocols and their sub-classes and automatic exploration of possible attack scenarios, 2) A firmware analysis framework with a novel query language and an analysis back-end, 3) A dynamic enforcement infrastructure that allows runtime vetting of devices prior to allowing machines to use them.  \r\n\r\nThis project will create techniques and systems that can be broadly deployed in consumer, enterprise, government and military environments. The lessons learned from building frameworks in the USB and Bluetooth environments can serve as a larger goal towards developing integrity frameworks for general-purpose embedded and internet-of-things (IoT) environments.  \r\n\r\nThe products of this project will be maintained for at least the duration of the project. Data and code from this project will be stored on the website www.firmware-analysis.org.\r\n\r\nThis award reflects NSF's statutory mission and has been deemed worthy of support through evaluation using the Foundation's intellectual merit and broader impacts review criteria.",
 "awd_arra_amount": 0.0,
 "dir_abbr": "CSE",
 "org_dir_long_name": "Directorate for Computer and Information Science and Engineering",
 "div_abbr": "CNS",
 "org_div_long_name": "Division Of Computer and Network Systems",
 "awd_agcy_code": "4900",
 "fund_agcy_code": "4900",
 "pi": [
  {
   "pi_role": "Principal Investigator",
   "pi_first_name": "Kevin",
   "pi_last_name": "Butler",
   "pi_mid_init": "",
   "pi_sufx_name": "",
   "pi_full_name": "Kevin Butler",
   "pi_email_addr": "butler@cise.ufl.edu",
   "nsf_id": "000573521",
   "pi_start_date": "2018-08-09",
   "pi_end_date": null
  },
  {
   "pi_role": "Co-Principal Investigator",
   "pi_first_name": "Tuba",
   "pi_last_name": "Yavuz",
   "pi_mid_init": "",
   "pi_sufx_name": "",
   "pi_full_name": "Tuba Yavuz",
   "pi_email_addr": "tuba@ece.ufl.edu",
   "nsf_id": "000487976",
   "pi_start_date": "2018-08-09",
   "pi_end_date": null
  }
 ],
 "inst": {
  "inst_name": "University of Florida",
  "inst_street_address": "1523 UNION RD RM 207",
  "inst_street_address_2": "",
  "inst_city_name": "GAINESVILLE",
  "inst_state_code": "FL",
  "inst_state_name": "Florida",
  "inst_phone_num": "3523923516",
  "inst_zip_code": "326111941",
  "inst_country_name": "United States",
  "cong_dist_code": "03",
  "st_cong_dist_code": "FL03",
  "org_lgl_bus_name": "UNIVERSITY OF FLORIDA",
  "org_prnt_uei_num": "",
  "org_uei_num": "NNFQH1JAPEP3"
 },
 "perf_inst": {
  "perf_inst_name": "University of Florida",
  "perf_str_addr": "1 University of Florida",
  "perf_city_name": "Gainesville",
  "perf_st_code": "FL",
  "perf_st_name": "Florida",
  "perf_zip_code": "326112002",
  "perf_ctry_code": "US",
  "perf_cong_dist": "03",
  "perf_st_cong_dist": "FL03",
  "perf_ctry_name": "United States",
  "perf_ctry_flag": "1"
 },
 "pgm_ele": [
  {
   "pgm_ele_code": "806000",
   "pgm_ele_name": "Secure &Trustworthy Cyberspace"
  }
 ],
 "pgm_ref": [
  {
   "pgm_ref_code": "021Z",
   "pgm_ref_txt": "Industry Partnerships"
  },
  {
   "pgm_ref_code": "025Z",
   "pgm_ref_txt": "SaTC: Secure and Trustworthy Cyberspace"
  },
  {
   "pgm_ref_code": "7434",
   "pgm_ref_txt": "CNCI"
  },
  {
   "pgm_ref_code": "7923",
   "pgm_ref_txt": "SMALL PROJECT"
  }
 ],
 "app_fund": [
  {
   "app_code": "0118",
   "app_name": "NSF RESEARCH & RELATED ACTIVIT",
   "app_symb_id": "040100",
   "fund_code": "01001819DB",
   "fund_name": "NSF RESEARCH & RELATED ACTIVIT",
   "fund_symb_id": "040100"
  }
 ],
 "oblg_fy": [
  {
   "fund_oblg_fiscal_yr": 2018,
   "fund_oblg_amt": 333328.0
  }
 ],
 "por": {
  "por_cntn": "<div class=\"porColContainerWBG\">\n<div class=\"porContentCol\"><p>Embedded systems play a large role in our daily lives. They are found in everything from computers and consumer electronics to appliances and automobiles. Many of them, however, use inexpensive microcontrollers that cannot easily be analyzed, so it is unclear how well they operate in practice and the implications of their use on device security has been largely unknown.&nbsp;<br />This project has made significant progress to assure safety and security of embedded devices through investigation of microcontroller firmware. We have developed solutions for determining which protocols are running on embedded IoT devices that user microcontroller architectures, allowing the learning of protocol models and automatically identifying functionality within unknown firmware. We extended binary analysis techniques into tooling used to evaluate side channels in Intel's SGX architecture and in cryptographic software, which has led to vulnerability reports and acknowledgment of our findings from Intel and software maintainers, and was presented at Intel's 2022 Security Conference.&nbsp;</p>\n<p><br />Our research has examined issues in peripherals using the USB and Bluetooth protocols. We have developed analysis frameworks that identified issues in firmware used by USB devices that could affect the hosts they plug into, and have reported multiple vulnerabilities to maintainers of the Linux and FreeBSD operating systems. With Bluetooth, we discovered a vulnerability that demonstrates a pervasive issue in the Bluetooth standard, allowing extraction of personal identifiers from devices that should not be visible to other devices. We also developed a mitigation for the issue that can operate in less than one microsecond on devices to secure them against this attack.</p>\n<p>We also considered a more expansive view of firmware to consider mobile devices and the processors on which they run. By examining firmware distributed with Android mobile devices, we developed a framework for understanding the various access control policy mechanisms into a large policy graph that we could effectively reason over, highlighting how external peripherals could create an attack surface for highly privileged processes. With regards to embedded peripherals, we developed modules for the Linux operating system that demonstrated how a general security framework for defending against malicious peripherals could be created. We also examined device drivers, which are used by operating systems to control input and output peripheral devices, could the source of vulnerabilities. We developed an automated approach for detecting deep bugs and vulnerabilities involving callback mechanisms within device drivers, and extended this framework to find vulnerabilities due to UNIX socket mechanisms, which were provided to mobile device vendors who acknowledged our findings and changed their software as a result of this research. We have also considered the firmware on storage devices and developed novel mechanisms for secure deletion using non-volatile memory.<br />Finally, we have continued our focus on firmware in other microcontroller environments, specifically withing cellular baseband processors. Our FirmWire framework demonstrated how mobile device firmware could be \"rehosted\" or emulated within a software environment, allowing for more efficient testing and the ability to perform detailed vulnerability analysis using techniques such as fuzzing. We discovered multiple critical vulnerabilities disclosed to mobile device vendors through this system, which has been used within industry and government.</p>\n<p>This work has led to numerous publications and issued patents, and has had significant training impact undergraduate, MS, and PhD students. Students funded from this work have graduated and taken positions at Purdue University, Qualcomm Research, and Intel Corporation.</p><br>\n<p>\n\t\t\t\t      \tLast Modified: 05/02/2023<br>\n\t\t\t\t\tModified by: Kevin&nbsp;Butler</p>\n</div>\n<div class=\"porSideCol\"></div>\n</div>",
  "por_txt_cntn": "\nEmbedded systems play a large role in our daily lives. They are found in everything from computers and consumer electronics to appliances and automobiles. Many of them, however, use inexpensive microcontrollers that cannot easily be analyzed, so it is unclear how well they operate in practice and the implications of their use on device security has been largely unknown. \nThis project has made significant progress to assure safety and security of embedded devices through investigation of microcontroller firmware. We have developed solutions for determining which protocols are running on embedded IoT devices that user microcontroller architectures, allowing the learning of protocol models and automatically identifying functionality within unknown firmware. We extended binary analysis techniques into tooling used to evaluate side channels in Intel's SGX architecture and in cryptographic software, which has led to vulnerability reports and acknowledgment of our findings from Intel and software maintainers, and was presented at Intel's 2022 Security Conference. \n\n\nOur research has examined issues in peripherals using the USB and Bluetooth protocols. We have developed analysis frameworks that identified issues in firmware used by USB devices that could affect the hosts they plug into, and have reported multiple vulnerabilities to maintainers of the Linux and FreeBSD operating systems. With Bluetooth, we discovered a vulnerability that demonstrates a pervasive issue in the Bluetooth standard, allowing extraction of personal identifiers from devices that should not be visible to other devices. We also developed a mitigation for the issue that can operate in less than one microsecond on devices to secure them against this attack.\n\nWe also considered a more expansive view of firmware to consider mobile devices and the processors on which they run. By examining firmware distributed with Android mobile devices, we developed a framework for understanding the various access control policy mechanisms into a large policy graph that we could effectively reason over, highlighting how external peripherals could create an attack surface for highly privileged processes. With regards to embedded peripherals, we developed modules for the Linux operating system that demonstrated how a general security framework for defending against malicious peripherals could be created. We also examined device drivers, which are used by operating systems to control input and output peripheral devices, could the source of vulnerabilities. We developed an automated approach for detecting deep bugs and vulnerabilities involving callback mechanisms within device drivers, and extended this framework to find vulnerabilities due to UNIX socket mechanisms, which were provided to mobile device vendors who acknowledged our findings and changed their software as a result of this research. We have also considered the firmware on storage devices and developed novel mechanisms for secure deletion using non-volatile memory.\nFinally, we have continued our focus on firmware in other microcontroller environments, specifically withing cellular baseband processors. Our FirmWire framework demonstrated how mobile device firmware could be \"rehosted\" or emulated within a software environment, allowing for more efficient testing and the ability to perform detailed vulnerability analysis using techniques such as fuzzing. We discovered multiple critical vulnerabilities disclosed to mobile device vendors through this system, which has been used within industry and government.\n\nThis work has led to numerous publications and issued patents, and has had significant training impact undergraduate, MS, and PhD students. Students funded from this work have graduated and taken positions at Purdue University, Qualcomm Research, and Intel Corporation.\n\n\t\t\t\t\tLast Modified: 05/02/2023\n\n\t\t\t\t\tSubmitted by: Kevin Butler"
 }
}